webpackJsonp([24],{"/ufY":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={data:function(){return{WorkDailyDetailDto:{},imageUrlList:[],uploadFileUrlapp:"https://httpbin.org/post",imgVideoBase64List:[],Describe:[],Arrange:[],ImagesPage:0,loading:!1,loadingText:"",Isitover:!1}},computed:{},watch:{},methods:{UpdataIf:function(){var t=this;this.$confirm("上传后不可修改, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.UpaData()}).catch(function(){t.$message({type:"info",message:"已取消"})})},UpaData:function(){var t=this;console.log(this.imgVideoBase64List);for(var e=[],i=[],a=0;a<this.Describe.length;a++){var s=this.Describe[a].text;""!=s&&void 0!=s&&e.push(s)}for(var o=0;o<this.Arrange.length;o++){var n=this.Arrange[o].text;""!=n&&void 0!=n&&i.push(n)}console.log(e),console.log(i),this.loading=!0,this.loadingText="正在上传文字内容 ~ ";var l={api:"post",url:this.$store.state.http+"PCenter/AddWorkDailyContent",data:{WorkDailyId:this.$store.state.Vuex.Id,Contents:e,Plans:i}};this.$https(l).then(function(e){console.log(e),0!=t.imgVideoBase64List.length?(t.iFbase64(),t.loadingText="正在上传图片 ~ "):(t.loading=!1,t.loadingText="",t.Code0())})},iFbase64:function(){this.imgVideoBase64List.length==this.ImagesPage?(this.loading=!1,this.loadingText="上传完成！",console.log("上传完成！"),this.Code0()):(this.Upimages(),this.ImagesPage+=1,this.loadingText="正在上传第"+this.ImagesPage+"张图片 ~ ")},Upimages:function(){var t=this,e=this.imgVideoBase64List[this.ImagesPage].base64,i={api:"post",url:this.$store.state.http+"PCenter/UploadWorkDailyPhoto",data:{Id:this.$store.state.Vuex.Id,FileStr:e}};this.$https(i).then(function(e){console.log(e),t.iFbase64()})},Code0:function(){var t=this,e={api:"post",url:this.$store.state.http+"PCenter/UploadWorkDaily",data:{Id:this.$store.state.Vuex.Id,type:this.Isitover?1:0}};this.$https(e).then(function(e){t.$emit("refresh"),t.$router.push({path:"Mywork"})})},getRBData:function(){var t=this,e={api:"get",url:this.$store.state.http+"PCenter/GetWorlDaily",data:{workdailyId:this.$store.state.Vuex.Id}};this.$https(e).then(function(e){console.log(e.Data),t.WorkDailyDetailDto=e.Data.WorkDailyDetailDto})},beforeuploadMainGraph:function(t){var e=(t.size/1024/1024).toFixed(3);if(console.log(e+"MB"),console.log(t),e>10&&"video/mp4"==t.type)return this.$look("warning","提示！","视频文件大小不得超过10MB"),!1;var i=this,a=new FileReader;a.readAsDataURL(t),a.onload=function(e){var s=a.result;i.imgVideoBase64List.push({uid:t.uid,base64:s})}},handleSuccessMainGraph:function(t,e,i){this.imageUrlList=i},handlePreviewMainGraph:function(t){this.imageUrl.type=t.raw.type,this.imageUrl.url=t.url,console.log(t),this.dialogVisibleMainGraph=!0},beforeremoveMainGraph:function(t,e){},handleRemoveMainGraph:function(t,e){console.log(t.uid);for(var i=0;i<this.imgVideoBase64List.length;i++){this.imgVideoBase64List[i].uid===t.uid&&this.imgVideoBase64List.splice(i,1)}console.log(this.imgVideoBase64List)}},created:function(){console.log(this.$store.state.Vuex.Id),this.getRBData()}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box_s",attrs:{"element-loading-text":t.loadingText}},[i("div",{staticClass:"head"},[t._v("日报基础信息")]),t._v(" "),i("div",{staticClass:"inp"},[i("p",{staticClass:"baiop"},[t._v("客户：")]),t._v(" "),i("span",[t._v(t._s(t.WorkDailyDetailDto.CustomerName))])]),t._v(" "),i("div",{staticClass:"inp"},[i("p",{staticClass:"baiop"},[t._v("服务日期：")]),t._v(" "),i("span",[t._v(t._s(t.WorkDailyDetailDto.ServiceDate))])]),t._v(" "),i("div",{staticClass:"inp"},[i("p",{staticClass:"baiop"},[t._v("创建时间：")]),t._v(" "),t.WorkDailyDetailDto.CreateDate?i("span",[t._v(t._s(t.WorkDailyDetailDto.CreateDate.split("T")[0]))]):t._e()]),t._v(" "),i("div",{staticClass:"inp"},[i("p",{staticClass:"baiop"},[t._v("工程师：")]),t._v(" "),i("span",[t._v(t._s(t.WorkDailyDetailDto.Engineer))])]),t._v(" "),i("div",{staticClass:"head"},[t._v("联系人")]),t._v(" "),i("div",{staticClass:"inp"},[i("p",{staticClass:"baiop"},[t._v("联系人：")]),t._v(" "),i("span",[t._v(t._s(t.WorkDailyDetailDto.LinkMan))])]),t._v(" "),i("div",{staticClass:"inp"},[i("p",{staticClass:"baiop"},[t._v("电话：")]),t._v(" "),i("span",[t._v(t._s(t.WorkDailyDetailDto.LinkTel))])]),t._v(" "),i("div",{staticClass:"inp"},[i("p",{staticClass:"baiop"},[t._v("邮箱：")]),t._v(" "),i("span",[t._v(t._s(t.WorkDailyDetailDto.LinkEmail))])]),t._v(" "),i("div",{staticClass:"head"},[t._v("是否完结")]),t._v(" "),i("div",{staticClass:"inp"},[i("el-switch",{attrs:{"active-text":"已完结","inactive-color":"red","inactive-text":"未完结"},model:{value:t.Isitover,callback:function(e){t.Isitover=e},expression:"Isitover"}})],1),t._v(" "),i("div",{staticClass:"head"},[t._v("工作描述/预计工作安排")]),t._v(" "),i("div",{staticClass:"ForTextHead"},[t._v("工作描述   "),i("i",{staticClass:"el-icon-circle-plus-outline Add",on:{click:function(e){return t.Describe.push({text:""})}}})]),t._v(" "),t._l(t.Describe,function(e,a){return i("div",{key:a+"sss",staticClass:"ForText"},[i("i",{staticClass:"el-icon-delete-solid del",on:{click:function(e){return t.Describe.splice(a,1)}}}),t._v(" "),i("el-input",{staticStyle:{marginTop:"5px"},attrs:{type:"textarea",autosize:"",placeholder:"请输入工作描述"},model:{value:e.text,callback:function(i){t.$set(e,"text",i)},expression:"item.text"}})],1)}),t._v(" "),i("div",{staticClass:"ForTextHead"},[t._v("工作安排   "),i("i",{staticClass:"el-icon-circle-plus-outline Add",on:{click:function(e){return t.Arrange.push({text:""})}}})]),t._v(" "),t._l(t.Arrange,function(e,a){return i("div",{key:a,staticClass:"ForText"},[i("i",{staticClass:"el-icon-delete-solid del",on:{click:function(e){return t.Arrange.splice(a,1)}}}),t._v(" "),i("el-input",{staticStyle:{marginTop:"5px"},attrs:{type:"textarea",autosize:"",placeholder:"请输入预计工作安排"},model:{value:e.text,callback:function(i){t.$set(e,"text",i)},expression:"Arrangeitem.text"}})],1)}),t._v(" "),i("div",{staticClass:"head"},[t._v("图片")]),t._v(" "),i("el-upload",{attrs:{action:t.uploadFileUrlapp,data:{attachType:0},name:"appFile",limit:10,multiple:!0,accept:"image/*,video/*","before-upload":t.beforeuploadMainGraph,"on-success":t.handleSuccessMainGraph,"on-preview":t.handlePreviewMainGraph,"before-remove":t.beforeremoveMainGraph,"on-remove":t.handleRemoveMainGraph,"list-type":"picture-card","file-list":t.imageUrlList}},[i("i",{staticClass:"el-icon-plus spc1"})]),t._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.UpdataIf()}}},[t._v("上传")])],2)},staticRenderFns:[]};var o=i("VU/8")(a,s,!1,function(t){i("TEIt")},"data-v-c6f17348",null);e.default=o.exports},TEIt:function(t,e){}});