webpackJsonp([58],{NWHB:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={data:function(){return{gridData:[],dialogTableVisible:!1,dialogTableVisible2:!1,search:"",POCode:"",SBData:[],POConsignee:{Name:"",EnginnerName:"",Mobile:"",Address:""},Memo:"",emptyText:"数据较多,必须输入检索项(右上角)",drawer:!1,dialogTableVisible3:!1,GetProducts2:{pageNum:"1",numPerPage:10,orderField:"",orderDirection:"",proType:1,productCode:"",barcodeMemo:"",man:"",desc:"",memo:""},Datatable:[],total:0,BrandList:[],DataPO:{Creater:""},LogisticCharge:0,Amount:0,SentStatus:0,PayStatus:0,PayType:0,Status:0,ProAmount:0}},computed:{},watch:{},methods:{GetCusLinkmanMini:function(){var t=this;if(""==this.search)return this.gridData=[],this.emptyText="必须输入检索项",!1;this.emptyText="正在查询 ··· ···";var e={api:"get",url:this.$store.state.http+"System/GetCusLinkmanMini",data:{search:this.search}};this.$https(e).then(function(e){console.log(e),t.gridData=e.Data})},GetEmployeeMini:function(){var t=this;this.dialogTableVisible=!0;var e={api:"get",url:this.$store.state.http+"System/GetEmployeeMini",data:{type:3}};this.$https(e).then(function(e){console.log(e),t.gridData=e.Data})},Choose:function(t){console.log(t),this.POConsignee=t,this.dialogTableVisible=!1,this.dialogTableVisible2=!1},handleClose:function(t){var e=this;this.$confirm("确认关闭？").then(function(s){t(),e.Datatable=[]}).catch(function(t){})},deleteOK:function(t){var e=this;console.log(t);var s={api:"post",url:this.$store.state.http+"PO/DelPoGood",data:{ID:t.POGoodId}};this.$https(s).then(function(t){console.log(t),e.initData(),e.$look("success","成功！","删除成功！")})},initss:function(t){var e=this;"1"==t&&(this.GetProducts2.pageNum="1");var s={api:"get",url:this.$store.state.http+"Product/GetProducts2",data:this.GetProducts2};this.$https(s).then(function(t){console.log(t),e.Datatable=t.Data.Dtos;for(var s=0;s<e.Datatable.length;s++){var i=e.Datatable[s];e.$set(i,"Number",1)}e.total=t.Data.DataBars})},handleCurrentChange:function(t){this.GetProducts2.pageNum=t,this.initss()},handleSizeChange:function(t){this.GetProducts2.numPerPage=t,this.initss(1)},GetBrand:function(){var t=this,e={api:"get",url:this.$store.state.http+"System/GetBrand"};this.$https(e).then(function(e){t.BrandList=e.Data;for(var s=0;s<t.BrandList.length;s++)t.BrandList[s].value=t.BrandList[s].Value})},querySearch:function(t,e){if(void 0==t)return t="",e(this.BrandList),!1;if(""==t)return e(this.BrandList),!1;for(var s=t,i=this.BrandList,a=[],n=(s.split("")[0],0);n<i.length;n++){var o=i[n];-1!=o.value.indexOf(s)&&a.push(o)}e(a)},adds:function(t){var e=this,s={api:"post",url:this.$store.state.http+"PO/AddPoGoods",data:{POID:this.DataPO.Id,POGoodDtos:[{ProductId:t.ID,Number:t.Number,BuyingUnitPrice:t.BuyingUnitPrice}]}};this.$https(s).then(function(t){e.initData(),e.$look("success","成功！","添加成功！")}),this.drawer=!1},addscheck:function(){for(var t=this,e=this.$refs.multipleTable.selection,s=[],i=0;i<e.length;i++){var a=e[i];s.push({ProductId:a.ID,Number:a.Number,BuyingUnitPrice:a.BuyingUnitPrice})}var n={api:"post",url:this.$store.state.http+"PO/AddPoGoods",data:{POID:this.DataPO.Id,POGoodDtos:s}};this.$https(n).then(function(e){t.initData(),t.$look("success","成功！","添加成功！")}),this.drawer=!1},AddPO:function(){for(var t=this,e=[],s=0;s<this.SBData.length;s++){var i=this.SBData[s];e.push({ProductId:i.ID,Number:i.ID})}if(0==e.length)return this.$look("warning","提示！","请选择想要采购的设备！"),!1;if(""==this.POCode)return this.$look("warning","提示！","请输入采购单号！"),!1;if(""==this.POConsignee.Name)return this.$look("warning","提示！","请输入收货人姓名！"),!1;if(""==this.POConsignee.EnginnerName)return this.$look("warning","提示！","请输入收货人英文名！"),!1;if(""==this.POConsignee.Mobile)return this.$look("warning","提示！","请输入收货人手机号！"),!1;if(""==this.POConsignee.Address)return this.$look("warning","提示！","请输入收货人地址！"),!1;var a={api:"post",url:this.$store.state.http+"PO/AddPO",data:{POCode:this.POCode,Memo:this.Memo,POConsignee:this.POConsignee,POGoodDtos:e}};this.$https(a).then(function(e){console.log(e),t.$emit("refresh"),t.$router.push({path:"/ListOfPurchaseOrders"})})},initData:function(){var t=this,e={api:"get",url:this.$store.state.http+"PO/GetPO",data:{poId:this.$store.state.Vuex.Id}};this.$https(e).then(function(e){console.log(e.Data.PODetailDto);var s=e.Data.PODetailDto;t.SBData=s.POGoodDtos;for(var i=0;i<t.SBData.length;i++)t.$set(t.SBData[i],"NumberFH","");t.ProAmount=s.ProAmount,t.Memo=s.Memo,t.POCode=s.POCode,t.POConsignee=s.POConsignee,t.DataPO=s,t.Amount=s.Amount,t.LogisticCharge=s.LogisticCharge,t.SentStatus=s.SentStatus,t.PayStatus=s.PayStatus,t.PayType=s.PayType,t.Status=s.Status,"1"==t.DataPO.PayType&&(t.DataPO.PayType="预付"),"2"==t.DataPO.PayType&&(t.DataPO.PayType="到付"),"3"==t.DataPO.PayType&&(t.DataPO.PayType="未知")})},UpdatePoGood:function(t,e){var s=this;"汇率"==e&&(t.BuyingUnitPrice=Number(t.OriginalCurrencyUnitPrice)*Number(t.Rate));var i={api:"post",url:this.$store.state.http+"PO/UpdatePoGood",data:{POGoodId:t.POGoodId,BuyingUnitPrice:t.BuyingUnitPrice,Number:t.Number,Rate:t.Rate}};this.$https(i).then(function(t){s.initData(),s.$look("success","成功！","修改成功！")})},SavePO:function(){var t=this,e={api:"post",url:this.$store.state.http+"PO/SavePO",data:{Id:this.$store.state.Vuex.Id,Amount:this.Amount,LogisticCharge:this.LogisticCharge,POConsignee:this.POConsignee,Memo:this.Memo}};this.$https(e).then(function(e){console.log(e),t.initData(),t.$look("success","成功！","已保存！")})},UpdatePoState:function(t){var e=this;if("1"==t){var s=this.SBData[0].BuyingCurrency;console.log(s);for(var i=0;i<this.SBData.length;i++){if(this.SBData[i].BuyingCurrency!=s)return this.$look("warning","提示！","请统一币种！"),!1}}console.log(t);var a={api:"post",url:this.$store.state.http+"PO/UpdatePoState",data:{POId:this.$store.state.Vuex.Id,Memo:this.Memo,ToSentStatus:t}};this.$https(a).then(function(s){e.$look("success","成功！","操作成功！"),4==t&&(e.$emit("refresh"),e.$router.push({path:"/ListOfPurchaseOrders"})),1==t&&e.SavePO()})},SupplierSendPO:function(){for(var t=this,e=[],s=0;s<this.SBData.length;s++){var i=this.SBData[s];if(0!=i.NumberFH&&""!=i.NumberFH&&null!=i.NumberFH&&void 0!=i.NumberFH){if(i.Number<Number(i.NumberFH)+Number(i.SentGoodsQuantity))return this.$look("error","发货数量超出！","第"+(s+1)+"条发货数量超出,单号为 :"+i.ProductCode),!1;e.push({Id:i.POGoodId,Value:i.NumberFH})}this.$set(this.SBData[s],"NumberFH",0)}if(0==e.length)return!1;var a={api:"post",url:this.$store.state.http+"PO/SupplierSendPO",data:{POId:this.$store.state.Vuex.Id,Memo:this.Memo,SentGoods:e}};this.$https(a).then(function(e){console.log(e),t.initData(),t.$look("success","成功！","正在发货!")})},SetPOPayType:function(t){var e=this,s={api:"post",url:this.$store.state.http+"PO/SetPOPayType",data:{Id:this.$store.state.Vuex.Id,Type:t}};this.$https(s).then(function(t){console.log(t),e.initData(),e.$look("success","成功！","操作成功！")})},DelPo:function(){var t=this,e={api:"post",url:this.$store.state.http+"PO/SetPOPayType",data:{Id:this.$store.state.Vuex.Id,Str:this.Memo}};this.$https(e).then(function(e){console.log(e),t.$emit("refresh"),t.$router.push({path:"/ListOfPurchaseOrders"})})},POPay:function(t){var e=this,s={api:"post",url:this.$store.state.http+"po/POPay",data:{Id:this.$store.state.Vuex.Id,Type:t}};this.$https(s).then(function(s){e.initData(),e.$look("success","成功！","1"==t?"付款成功！":"驳回成功！")})},POModifyPrice:function(){var t=this,e={api:"post",url:this.$store.state.http+"PO/POModifyPrice",data:{Id:this.$store.state.Vuex.Id,Str:this.LogisticCharge,Type:this.Amount}};this.$https(e).then(function(e){t.initData(),t.$look("success","成功！","调整成功！")})},POApplyPay:function(){var t=this,e={api:"post",url:this.$store.state.http+"PO/POApplyPay",data:{Id:this.$store.state.Vuex.Id}};this.$https(e).then(function(e){t.initData(),t.$look("success","成功！","操作成功！")})}},created:function(){this.initData(),this.GetBrand()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"box_s"},[s("div",{staticClass:"segmentation"},[t._v("\n    基础信息\n  ")]),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("发起人：")]),t._v(" "),s("span",{staticClass:"span"},[t._v(t._s(t.DataPO.Creater))])]),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("付款方式：")]),t._v(" "),s("span",{staticClass:"span"},[t._v(t._s(t.DataPO.PayType))])]),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("付款状态 ：")]),t._v(" "),s("span",[t._v(t._s(t.DataPO.PayStatusStr))])]),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("发货状态 ：")]),t._v(" "),s("span",[t._v(t._s(t.DataPO.SentStatusStr))])]),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("发货日期：")]),t._v(" "),s("span",{staticClass:"span"},[t._v(t._s(null!=t.DataPO.SendDate?t.DataPO.SendDate.split("T")[0]:" - - "))])]),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("收货日期：")]),t._v(" "),s("span",{staticClass:"span"},[t._v(t._s(null!=t.DataPO.ReceiptDate?t.DataPO.ReceiptDate.split("T")[0]:" - - "))])]),t._v(" "),s("div",{staticClass:"segmentation"},[t._v("\n    选择设备\n  ")]),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.SBData,size:"mini","highlight-current-row":"",border:"","header-cell-style":{background:"#e1e1e1"}}},[s("el-table-column",{attrs:{prop:"ProductCode",label:"产品编号",width:"170","show-overflow-tooltip":!0}}),t._v(" "),s("el-table-column",{attrs:{prop:"InchwellCode",label:"内部编码",width:"140","show-overflow-tooltip":!0}}),t._v(" "),s("el-table-column",{attrs:{prop:"Brand",label:"品牌",width:"120","show-overflow-tooltip":!0}}),t._v(" "),s("el-table-column",{attrs:{prop:"ProDesc",label:"产品描述","show-overflow-tooltip":!0}}),t._v(" "),s("el-table-column",{staticStyle:{float:"left"},attrs:{fixed:"right",label:"原币种单价",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",{staticStyle:{width:"49%","text-align":"right",float:"left"}},[t._v(t._s(e.row.OriginalCurrencyUnitPrice))]),t._v(" "),s("p",{staticStyle:{width:"49%","text-align":"right",float:"left","font-weight":"bold"}},[t._v(t._s(e.row.BuyingCurrency))])]}}])}),t._v(" "),s("el-table-column",{staticStyle:{float:"left"},attrs:{fixed:"right",label:"汇率",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input",{attrs:{size:"mini",placeholder:"请输入汇率"},on:{change:function(s){return t.UpdatePoGood(e.row,"汇率")}},model:{value:e.row.Rate,callback:function(s){t.$set(e.row,"Rate",s)},expression:"scope.row.Rate"}})]}}])}),t._v(" "),s("el-table-column",{staticStyle:{float:"left"},attrs:{fixed:"right",label:"购买单价",width:"154"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input-number",{attrs:{min:1,size:"mini"},on:{change:function(s){return t.UpdatePoGood(e.row)}},model:{value:e.row.BuyingUnitPrice,callback:function(s){t.$set(e.row,"BuyingUnitPrice",s)},expression:"scope.row.BuyingUnitPrice"}})]}}])}),t._v(" "),s("el-table-column",{staticStyle:{float:"left"},attrs:{fixed:"right",label:"添加数量",width:"154"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-input-number",{attrs:{min:1,size:"mini"},on:{change:function(s){return t.UpdatePoGood(e.row)}},model:{value:e.row.Number,callback:function(s){t.$set(e.row,"Number",s)},expression:"scope.row.Number"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return t.deleteOK(e.row)}}})]}}])})],1),t._v(" "),s("div",{staticClass:"WL"},[s("span",[t._v("物流费：")]),t._v(" "),s("el-input",{attrs:{size:"mini"},model:{value:t.LogisticCharge,callback:function(e){t.LogisticCharge=e},expression:"LogisticCharge"}})],1),t._v(" "),s("div",{staticClass:"WL"},[s("span",[t._v("总金额：")]),t._v(" "),s("p",[t._v(t._s(t.ProAmount))])]),t._v(" "),s("div",{staticClass:"WL"},[s("span",{staticStyle:{width:"90px"}},[t._v("优惠后金额：")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 91px)"},attrs:{size:"mini"},model:{value:t.Amount,callback:function(e){t.Amount=e},expression:"Amount"}})],1),t._v(" "),s("div",{staticClass:"segmentation"},[t._v("\n    收货人信息\n  ")]),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("采购单号:")]),t._v(" "),s("p",[t._v(t._s(t.POCode))])]),t._v(" "),s("div",{staticStyle:{width:"100%",float:"left"}}),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("姓名：")]),t._v(" "),s("el-input",{attrs:{size:"mini"},model:{value:t.POConsignee.Name,callback:function(e){t.$set(t.POConsignee,"Name",e)},expression:"POConsignee.Name"}})],1),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("英文名：")]),t._v(" "),s("el-input",{attrs:{size:"mini"},model:{value:t.POConsignee.EnginnerName,callback:function(e){t.$set(t.POConsignee,"EnginnerName",e)},expression:"POConsignee.EnginnerName"}})],1),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("手机：")]),t._v(" "),s("el-input",{attrs:{size:"mini"},model:{value:t.POConsignee.Mobile,callback:function(e){t.$set(t.POConsignee,"Mobile",e)},expression:"POConsignee.Mobile"}})],1),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("电话：")]),t._v(" "),s("el-input",{attrs:{size:"mini"},model:{value:t.POConsignee.Tel,callback:function(e){t.$set(t.POConsignee,"Tel",e)},expression:"POConsignee.Tel"}})],1),t._v(" "),s("div",{staticClass:"consignee"},[s("span",[t._v("邮箱：")]),t._v(" "),s("el-input",{attrs:{size:"mini"},model:{value:t.POConsignee.Email,callback:function(e){t.$set(t.POConsignee,"Email",e)},expression:"POConsignee.Email"}})],1),t._v(" "),s("div",{staticStyle:{width:"100%",float:"left"}}),t._v(" "),s("div",{staticClass:"consignee",staticStyle:{width:"800px"}},[s("span",[t._v("地址：")]),t._v(" "),s("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:10},placeholder:"请输入内容"},model:{value:t.POConsignee.Address,callback:function(e){t.$set(t.POConsignee,"Address",e)},expression:"POConsignee.Address"}})],1),t._v(" "),s("div",{staticStyle:{width:"100%",float:"left"}}),t._v(" "),s("div",{staticClass:"consignee",staticStyle:{width:"800px"}},[s("span",[t._v("备注：")]),t._v(" "),s("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:10},placeholder:"请输入内容"},model:{value:t.Memo,callback:function(e){t.Memo=e},expression:"Memo"}})],1)],1)},staticRenderFns:[]};var n=s("VU/8")(i,a,!1,function(t){s("zuuN")},"data-v-586cb866",null);e.default=n.exports},zuuN:function(t,e){}});