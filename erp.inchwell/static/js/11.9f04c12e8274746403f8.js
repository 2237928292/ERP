webpackJsonp([11],{"1H3f":function(t,e,n){t.exports=n.p+"static/img/favicon.6c85fa4.png"},impz:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d={data:function(){return{Str:"",BaleTable:[],inchwellimg:n("1H3f"),ToolsData:[],StockData:[]}},computed:{},watch:{},methods:{permil1:function(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},DekExcel:function(){var t=this,e={api:"post",url:this.$store.state.http+"Maintain/ASCostStat",data:{Str:this.Str}};this.$https(e).then(function(e){console.log(e.Data),t.BaleTable=e.Data,t.DekExcel1()})},DekExcel1:function(){for(var t="width:165px;min-height:80px;line-height:50px;",e="width:50px;min-height:80px;line-height:50px;",n="width:250px;min-height:40px;line-height:50px;",d="width:250px;min-height:80px;line-height:50px;",o="text-align:center;",l="Repair case for "+this.BaleTable.ContractNo+" in "+this.BaleTable.Begin.split("T")[0]+" to "+this.BaleTable.End.split("T")[0],a="上门总次数："+this.BaleTable.ComeTotalDtos.TotalCount,i="width:165px;height:70;background:#f60;line-height:70px;font-size:30px;text-align:center;font-weight:bolder;",s="background:#ee0;font-weight:bolder;font-size:20px;height:100px;line-height:33px;",r="",c=0,h=0,p=0;p<this.BaleTable.ASCostStatPartDtos.length;p++){c+=(u=this.BaleTable.ASCostStatPartDtos[p]).TotalPrice,h+=u.TotalCost;for(var f="",x=0;x<u.Details.length;x++)f+='<span style="color:#0000ff;" >'+(x+1)+"</span>.  "+u.Details[x]+"<br>";r+="\n                    <tr>\n                        <td style='"+(e+o)+"'>"+(p+1)+"</td>\n                        <td style='"+(d+o)+"'>"+u.SOCode+"</td>\n                        <td style='width:400px;padding:30px 0 30px 0;box-sizing:border-box;'>"+f+"</td>\n                         <td style='"+(t+o)+"'>"+this.permil1(u.TotalCost)+"</td>\n                        <td style='"+(t+o)+"'>"+this.permil1(u.TotalPrice)+"</td>\n                        <td style='"+(t+o)+"'>"+u.ContactINF+"</td>\n                        <td style='"+(t+o)+"'>"+(null==u.Engineers?" - ":u.Engineers)+"</td>\n                        <td style='"+(t+o)+"'>"+u.Remark+"</td>\n                    </tr>\n                "}r+="\n                    <tr>\n                        <td  colspan='3' style='"+(t+o)+"' > TOTAL</td>\n                        <td style='"+(t+o)+"'>"+this.permil1(h)+"</td>\n                        <td style='"+(t+o)+"'>"+this.permil1(c)+"</td>\n                        <td style='"+(t+o)+"'></td>\n                        <td style='"+(t+o)+"'></td>\n                        <td style='"+(t+o)+"'></td>\n                    </tr>\n                ";for(var m="\n                    <tr>\n                        <td  ></td>\n                        <td style='"+(n+o)+"color:#0000ff;'>服务内容</td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                    </tr>\n                ",y=0;y<this.BaleTable.ComeTotalDtos.CountDetail.length;y++){m+="\n                    <tr>\n                        <td ></td>\n                        <td style='"+(n+o)+"'>"+(u=this.BaleTable.ComeTotalDtos.CountDetail[y])+"</td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                    </tr>\n                "}m+="\n                    <tr>\n                        <td ></td>\n                        <td style='"+(n+o)+"color:#0000ff;'>服务人员</td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                    </tr>\n                ";for(var g=0;g<this.BaleTable.ComeTotalDtos.EngineerDetail.length;g++){var u;m+="\n                    <tr>\n                        <td ></td>\n                        <td style='"+(n+o)+"'>"+(u=this.BaleTable.ComeTotalDtos.EngineerDetail[g])+"</td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                        <td ></td>\n                    </tr>\n                "}var b='\n\t\t\t<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n\t\t\t<head>\n\t\t\t\t<meta charset="utf-8">\n\t\t\t</head>\n\t\t\t<body>\n                <table border=1 style="font-family: "宋体";">\n                    <tr>    \n                    <img src="http://39.101.201.199:8005/images/inchwell.png" alt=""   />\n                        <td colspan=\'8\' style=\'width:165px;height:150px;line-height:120px;color:#0000ff;font-size:40px;padding-left:180px;box-sizing:border-box;font-family:宋体;font-weight:bolder;\'>\n                        <p>北京英之杰天祥汽车技术服务有限公司 <br> <span  style=\'font-family:none;font-size:30px;font-weight:bolder;'+"'> INCHWELL T & S (BEIJING) CO., LTD.</span> </p>\n                       \n                        </td>\n                    </tr>\n\n\n                    <tr>\n                        <td colspan='8' style='"+i+"'>"+l+"</td>\n                    </tr>\n\n                    <tr >\n                        <td style='"+(e+o+s)+"'>序号 <br> PO.</td>\n                        <td style='"+(d+o+s)+"'>订单单号 <br> SOcode </td>\n                        <td style='"+(t+o+s)+"'>维修内容 <br> Details</td>\n                        <td style='"+(t+o+s)+"'>成本合计 <br> TotalCost</td>\n                        <td style='"+(t+o+s)+"'>合同金额 <br> TOTAL</td>\n                        <td style='"+(t+o+s)+"'>客户联系方式 <br> CONTACT INF.</td>\n                         <td style='"+(t+o+s)+"'>维修工程师 <br> ENGINEERS FOR REPAIRING</td>\n                        <td style='"+(t+o+s)+"'>备注 <br> REMARKS</td>\n                    </tr>\n                    "+r+"\n                     <tr>\n                        <td colspan='8' style='"+i+"'>"+a+"</td>\n                    </tr>\n                    "+m+"\n\n\n               \n\n                </table>\n\t\t\t</body>\n\t\t\t</html>",C=document.createElement("a");C.download="北京英之杰天祥汽车技术服务有限公司 .xls",C.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(b))),document.body.appendChild(C),C.click(),document.body.removeChild(C)},StatLeaseTools:function(){var t=this,e={api:"get",url:this.$store.state.http+"Statistic/StatLeaseTools"};this.$https(e).then(function(e){console.log(e.Data),t.ToolsData=e.Data.Dtos,t.ExportTools()})},ExportTools:function(){for(var t="width:165px;min-height:150px;line-height:150px;background:#ed7",e="width:180px;min-height:80px;line-height:50px;text-align:left;",n="text-align:center;",d="background:#ee0;font-weight:bolder;font-size:20px;height:100px;line-height:33px;",o="",l=0;l<this.ToolsData.length;l++){var a=this.ToolsData[l];o+="\n                    <tr>\n                        <td style='"+e+"' >"+a.ToolCode+"</td>\n                        <td style='"+e+"' >"+a.BMWCode+"</td>\n                        <td style='"+e+"' >"+a.StateStr+"</td>\n                        <td style='"+e+"' >"+a.Location+"</td>\n                        <td style='"+e+"' >"+a.Capital+"</td>\n                        <td style='"+e+"' >"+a.LeaseMoney+"</td>\n                        <td style='"+e+"' >"+a.GuZiCode+"</td>\n                        <td style='"+e+"' >"+a.Belong+"</td>\n                        <td style='"+e+"' >"+a.StorageDate+"</td>\n                        <td style='width:1000px;min-height:80px;line-height:50px;' >"+a.Describe+"</td>\n                    </tr>\n                "}var i='\n\t\t\t<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n\t\t\t<head>\n\t\t\t\t<meta charset="utf-8">\n\t\t\t</head>\n\t\t\t<body>\n                <table border=1 style="font-family: "宋体";">\n                    <tr >\n                        <td style=\''+(t+n+d)+"'>工具编号</td>\n                        <td style='"+(t+n+d)+"'>宝马工具编号</td>\n                        <td style='"+(t+n+d)+"'>状态</td>\n                        <td style='"+(t+n+d)+"'>仓库位置</td>\n                        <td style='"+(t+n+d)+"'>本金</td>\n                        <td style='"+(t+n+d)+"'>租赁费</td>\n                        <td style='"+(t+n+d)+"'>固资号</td>\n                        <td style='"+(t+n+d)+"'>所属</td>\n                        <td style='"+(t+n+d)+"'>入库日期</td>\n                        <td style='"+(t+n+d)+"'>描述</td>\n                    </tr>\n                  \n                    "+o+"\n\n\n               \n\n                </table>\n\t\t\t</body>\n\t\t\t</html>",s=document.createElement("a");s.download="实时租赁工具.xls",s.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(i))),document.body.appendChild(s),s.click(),document.body.removeChild(s)},StatStock:function(){var t=this,e={api:"get",url:this.$store.state.http+"Statistic/StatStock"};this.$https(e).then(function(e){console.log(e.Data),t.StockData=e.Data.StockDtos,t.ExportStockData()})},ExportStockData:function(){for(var t="width:165px;min-height:150px;line-height:150px;background:#ed7",e="width:180px;min-height:80px;line-height:50px;text-align:left;",n="width:250px;min-height:80px;line-height:50px;text-align:left;",d="text-align:center;",o="background:#ee0;font-weight:bolder;font-size:20px;height:100px;line-height:33px;",l="",a=0;a<this.StockData.length;a++){var i=this.StockData[a];i.BarcodeMemo="&nbsp;"+i.BarcodeMemo.toString(),l+="\n                    <tr>\n                        <td style='"+e+"' >"+i.CodeMemo+"</td>\n                        <td style='"+e+"' >"+i.Number+"</td>\n                        <td style='"+n+"' >"+i.ProductCode+"</td>\n                        <td style='"+n+"' >"+i.BarcodeMemo+"</td>\n                        <td style='"+e+"' >"+i.BuyingUnitPrice+"</td>\n                        <td style='"+e+"' >"+i.BuyingCurrency+"</td>\n                        <td style='"+e+"' >"+i.UnitPrice+"</td>\n                        <td style='width:1000px;min-height:80px;line-height:50px;' >"+i.Characteristics+"</td>\n                    </tr>\n                "}var s='\n\t\t\t<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n\t\t\t<head>\n\t\t\t\t<meta charset="utf-8">\n\t\t\t</head>\n\t\t\t<body>\n                <table border=1 style="font-family: "宋体";">\n                    <tr >\n                        <td style=\''+(t+d+o)+"'>库位</td>\n                        <td style='"+(t+d+o)+"'>数量</td>\n                        <td style='"+(t+d+o)+"'>产品编码</td>\n                        <td style='"+(t+d+o)+"'>内部编码</td>\n                        <td style='"+(t+d+o)+"'>采购价</td>\n                        <td style='"+(t+d+o)+"'>采购价单位</td>\n                        <td style='"+(t+d+o)+"'>售出价</td>\n                        <td style='"+(t+d+o)+"'>产品描述</td>\n                    </tr>\n                  \n                    "+l+"\n\n\n               \n\n                </table>\n\t\t\t</body>\n\t\t\t</html>",r=document.createElement("a");r.download="实时库存.xls",r.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(s))),document.body.appendChild(r),r.click(),document.body.removeChild(r)}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",staticStyle:{margin:"-10px"},attrs:{slot:"header"},slot:"header"},[n("span",[t._v("统计大包成本")]),t._v(" "),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){return t.DekExcel()}}},[t._v("导出")])],1),t._v(" "),n("div",{staticClass:"text item",staticStyle:{margin:"-10px",fontSize:"12px"}},[t._v("\n      "+t._s("请输入保养合同号:")+"\n      "),n("el-input",{staticStyle:{width:"400px"},attrs:{size:"mini",placeholder:"请输入保养合同号"},model:{value:t.Str,callback:function(e){t.Str=e},expression:"Str"}})],1)]),t._v(" "),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",staticStyle:{margin:"-10px"},attrs:{slot:"header"},slot:"header"},[n("span",[t._v("导出租赁工具")]),t._v(" "),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){return t.StatLeaseTools()}}},[t._v("导出")])],1)]),t._v(" "),n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",staticStyle:{margin:"-10px"},attrs:{slot:"header"},slot:"header"},[n("span",[t._v("导出实时库存")]),t._v(" "),n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){return t.StatStock()}}},[t._v("导出")])],1)])],1)},staticRenderFns:[]};var l=n("VU/8")(d,o,!1,function(t){n("mP7t")},"data-v-9f00d33c",null);e.default=l.exports},mP7t:function(t,e){}});