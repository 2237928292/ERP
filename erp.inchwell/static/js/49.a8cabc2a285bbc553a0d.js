webpackJsonp([49],{hNKd:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xu46"),n=a("PXCl").Base64,s={name:"",data:function(){return{WhetherToRenew:!1,MaintainRHF:!1,reverse:!0,drawer:!1,col:[{label:"序号",prop:"Pos",width:"80",sortable:!0},{label:"设备编码",prop:"ProductCode",width:"150",sortable:!0},{label:"品牌",prop:"Brand",width:"150",sortable:!0},{label:"描述",prop:"Desc",width:"",widths:!0,sortable:!0},{label:"保养单价",prop:"MaintainPrice",width:"100",sortable:!1},{label:"序列号",prop:"SN",width:"150",sortable:!0}],dropCol:[{label:"序号",prop:"Pos",width:"80",sortable:!0},{label:"设备编码",prop:"ProductCode",width:"150",sortable:!0},{label:"品牌",prop:"Brand",width:"150",sortable:!0},{label:"描述",prop:"Desc",width:"",widths:!0,sortable:!0},{label:"保养单价",prop:"MaintainPrice",width:"100",sortable:!1},{label:"序列号",prop:"SN",width:"150",sortable:!0}],CustomerType:"2",CustomerTypes:[{name:"全部",value:"1"},{name:"有序列号",value:"2"},{name:"无序列号",value:"3"}],Data:[],EquDtos:[],EquDtos1:[],search:"",Datatable:[],pageNum:1,pagesize:10,total:0,productCode:"",barcodeMemo:"",man:"",desc:"",memo:"",options:[],titlebatch:"",Type:"",BelongToCustomer:!0,searchs:"",CTTAMCAS:0,loading:!1,StateStr:"",MCCollectionss:"",GetMCPlistData:[],GetMCPlistDataList:0,EquDtosList:[],EquDtos1List:[],MCOrderDtos:[],Time1:"",PreferentialAmountSD:0,tableheight:300,MyEquipmentDatabaseState:0,code2:"",FinancialConfirmed:0,FinancialUnconfirmed:0,DataList:[],ContractWithOptionOfRenewal:!1}},filters:{TimeCode:function(t){return null==t||void 0==t||""==t?" - - ":t.split("T")[0]}},created:function(){var t=this;t.CTTAMCAS=0,window.onresize=function(){return function(){document.body.clientWidth;t.$store.state.docuwidth<1400?t.tableheight="400":t.tableheight="700"}()}},mounted:function(){this.initMaintenan()},methods:{IveChosen:function(){var t=this;if(console.log(this.$refs.SelectedContracts.selection),0==this.$refs.SelectedContracts.selection.length)return this.$look("warning","提示！","请至少选择一份合同！"),!1;for(var e=[],a=0;a<this.$refs.SelectedContracts.selection.length;a++){var i=this.$refs.SelectedContracts.selection[a];e.push(i.Id)}console.log(e);var n={api:"post",url:this.$store.state.http+"Maintain/MCBeRenewed",data:{MCId:this.$store.state.Vuex.MaintenanceContractDetailsID,BeRenewedIds:e}};this.$https(n).then(function(e){t.ContractWithOptionOfRenewal=!1,t.initMaintenan(),t.$look("success","成功","请继续操作！")})},confirmOldContracts:function(){var t=this;this.$confirm("当前合同为续签合同还是新建合同？","提示",{confirmButtonText:"新建合同",cancelButtonText:"续签合同",type:"warning"}).then(function(){t.Receivables(4,"收款")}).catch(function(){var e={url:t.$store.state.http+"Maintain/GetMCs",api:"get",data:{pageNum:1,numPerPage:99999,orderField:"",orderDirection:"",search:"",state:"-1",cusFullName:t.Data.MCBaseInfo.CusFullName,area:"",cusType:"",begin:"",end:""}};t.$https(e).then(function(e){t.DataList=e.Data.Dtos;for(var a=0;a<t.DataList.length;a++){t.DataList[a].Id==t.$store.state.Vuex.MaintenanceContractDetailsID&&t.DataList.splice(a,1)}for(var i=0;i<t.DataList.length;i++){var n=t.DataList[i];n.CreateDate=n.CreateDate.split("T")[0],n.AcceptDate=null==n.AcceptDate?" - - ":n.AcceptDate.split("T")[0],n.PayDate=null==n.PayDate?" - - ":n.PayDate.split("T")[0]}console.log(t.DataList),t.ContractWithOptionOfRenewal=!0})})},ResetMC:function(){var t=this,e={api:"post",url:this.$store.state.http+"Maintain/ResetMC",data:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID}};this.$https(e).then(function(e){t.$look("success","恢复成功！",Row.MaintainCode+"的状态已恢复！")})},querySearch:function(t,e){if(void 0==t)return t="",e(this.options),!1;if(""==t)return e(this.options),!1;for(var a=t,i=this.options,n=[],s=(a.split("")[0],0);s<i.length;s++){var o=i[s];-1!=o.value.indexOf(a)&&n.push(o)}e(n)},handleSelect:function(t){this.initss()},MCCollections:function(){var t=this;if(""==this.MCCollectionss||0==this.MCCollectionss)return this.$look("warning","提示！",'请输入收款金额！（不可为 "0" ）'),!1;var e=Number(this.MCCollectionss)+Number(this.GetMCPlistDataList);if(console.log(e),e>this.PreferentialAmountSD)return console.log(this.PreferentialAmountSD,Number(this.GetMCPlistDataList)),this.$look("warning","收款超出应收金额！","剩余待收款"+(this.PreferentialAmountSD-Number(this.GetMCPlistDataList))+"元"),!1;var a={api:"post",url:this.$store.state.http+"maintain/MCCollections",data:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID,Str:this.MCCollectionss}};this.$https(a).then(function(e){console.log(e),t.GetMCPlist(),t.$look("success","成功！","已发起收款！")})},GetMCPlist:function(){var t=this,e={api:"GET",url:this.$store.state.http+"maintain/GetMCPlist",data:{id:this.$store.state.Vuex.MaintenanceContractDetailsID}};this.$https(e).then(function(e){t.GetMCPlistData=e.Data,console.log(t.GetMCPlistData),t.GetMCPlistDataList=0;for(var a=0;a<t.GetMCPlistData.length;a++){var i=t.GetMCPlistData[a];t.GetMCPlistDataList+=i.Amount,2==i.State?(console.log(i.Amount),t.FinancialConfirmed+=i.Amount):t.FinancialUnconfirmed+=i.Amount}})},SkipTheMaintenanceTask:function(){var t=this;this.loading=!0;var e={api:"post",url:this.$store.state.http+"maintain/UpdateMCState",data:{MCId:this.$store.state.Vuex.MaintenanceContractDetailsID,State:5}};this.$https(e).then(function(e){t.$look("success","成功！","已跳过保养任务！"),t.$router.push({path:"/MaintenanceManagement"}),t.loading=!1})},Receivables:function(t,e){var a=this;if(this.CTTAMCAS=0,this.loading)return!1;this.loading=!0;var i={api:"post",url:this.$store.state.http+"maintain/UpdateMCState",data:{MCId:this.$store.state.Vuex.MaintenanceContractDetailsID,State:t}};this.$https(i).then(function(t){a.$look("success","成功！",e+"成功！"),a.initMaintenan(),a.loading=!1})},saveMCAS:function(t,e){var a=this;if(this.loading)return!1;this.loading=!0;var i={url:this.$store.state.http+"Maintain/SaveMC",api:"post",data:{MCBaseInfo:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID,MaintainCode:this.Data.MCBaseInfo.MaintainCode,Memo:this.Data.MCBaseInfo.Memo,LinkMan:this.Data.MCBaseInfo.LinkMan,LinkManEngilsh:this.Data.MCBaseInfo.LinkManEngilsh,Mobile:this.Data.MCBaseInfo.Mobile},MCEquInfo:{YearLife:this.Data.MCEquInfo.YearLife,MaintainCount:this.Data.MCEquInfo.MaintainCount,AmountTotal:this.Data.MCEquInfo.AmountTotal,PreferentialAmount:this.Data.MCEquInfo.PreferentialAmount,PreferentialRatio:this.Data.MCEquInfo.PreferentialRatio,IsShowDiscount:this.Data.MCEquInfo.IsShowDiscount,TravelExpenses:this.Data.MCEquInfo.TravelExpenses,TraveTime:this.Data.MCEquInfo.TraveTime},ASEquInfo:{ASAmountTotal:this.Data.ASEquInfo.ASAmountTotal,ASPreferentialAmount:this.Data.ASEquInfo.ASPreferentialAmount,ASPreferentialRatio:this.Data.ASEquInfo.ASPreferentialRatio,YearOfEstablishment:this.Data.ASEquInfo.YearOfEstablishment,TotalNumberOfLifts:this.Data.ASEquInfo.TotalNumberOfLifts,QNHF:this.Data.ASEquInfo.QNHF,TotalNumberOfAirCompressor:this.Data.ASEquInfo.TotalNumberOfAirCompressor,TotalNumberOfSprayBooth:this.Data.ASEquInfo.TotalNumberOfSprayBooth}}};this.$https(i).then(function(i){if(a.CTTAMCAS=0,2==t||3==t||6==t||5==t){var n={api:"post",url:a.$store.state.http+"maintain/UpdateMCState",data:{MCId:a.$store.state.Vuex.MaintenanceContractDetailsID,State:t}};a.$https(n).then(function(t){a.$look("success","成功！",e+"成功！"),a.initMaintenan(),a.loading=!1})}else a.$look("success","成功！","保存成功！"),a.initMaintenan(),a.loading=!1})},saveMCASNO:function(t,e){var a={url:this.$store.state.http+"Maintain/SaveMC",api:"post",data:{MCBaseInfo:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID,MaintainCode:this.Data.MCBaseInfo.MaintainCode,Memo:this.Data.MCBaseInfo.Memo,LinkMan:this.Data.MCBaseInfo.LinkMan,LinkManEngilsh:this.Data.MCBaseInfo.LinkManEngilsh,Mobile:this.Data.MCBaseInfo.Mobile},MCEquInfo:{YearLife:this.Data.MCEquInfo.YearLife,MaintainCount:this.Data.MCEquInfo.MaintainCount,AmountTotal:this.Data.MCEquInfo.AmountTotal,PreferentialAmount:this.Data.MCEquInfo.PreferentialAmount,PreferentialRatio:this.Data.MCEquInfo.PreferentialRatio,IsShowDiscount:this.Data.MCEquInfo.IsShowDiscount,TravelExpenses:this.Data.MCEquInfo.TravelExpenses,TraveTime:this.Data.MCEquInfo.TraveTime},ASEquInfo:{ASAmountTotal:this.Data.ASEquInfo.ASAmountTotal,ASPreferentialAmount:this.Data.ASEquInfo.ASPreferentialAmount,ASPreferentialRatio:this.Data.ASEquInfo.ASPreferentialRatio,YearOfEstablishment:this.Data.ASEquInfo.YearOfEstablishment,TotalNumberOfLifts:this.Data.ASEquInfo.TotalNumberOfLifts,QNHF:this.Data.ASEquInfo.QNHF,TotalNumberOfAirCompressor:this.Data.ASEquInfo.TotalNumberOfAirCompressor,TotalNumberOfSprayBooth:this.Data.ASEquInfo.TotalNumberOfSprayBooth}}};this.$https(a).then(function(t){})},ChangeASPreferentialAmount:function(){var t=this.Data.MCEquInfo.MaintainCount,e=this.Data.ASEquInfo.YearOfEstablishment,a=this.Data.ASEquInfo.TotalNumberOfLifts,i=this.Data.ASEquInfo.TotalNumberOfAirCompressor,n=this.Data.ASEquInfo.TotalNumberOfSprayBooth;if(""==e||""==a||""==i||""==n)this.$look("warning","提示！","补全AS信息！");else{var s="宝马"==this.Data.MCBaseInfo.CusType?31400:"保时捷"==this.Data.MCBaseInfo.CusType?1e5:0,o=.05*(9-((new Date).getFullYear()-this.Data.ASEquInfo.YearOfEstablishment));o<0&&(o=0),o>.3&&(o=.3);var r=.0125*(this.Data.ASEquInfo.TotalNumberOfLifts-10);r<0&&(r=0),r>.2&&(r=.2);var l=35*(1-r-o);this.Data.ASEquInfo.ASAmountTotal=(35*a*300+n*s+2e4*i)*t,this.Data.ASEquInfo.ASPreferentialAmount=((a*l*300+n*s+2e4*i)*t).toFixed(2)}},CTTAMC:function(){for(var t=0,e=this.Data.MCEquInfo.EquDtos,a=0;a<e.length;a++){var i=e[a];t+=i.Number*i.MaintainPrice*i.MaintainCount}var n=this.Data.MCEquInfo.PreferentialRatio;this.Data.MCEquInfo.AmountTotal=t+this.Data.MCEquInfo.TravelExpenses*this.Data.MCEquInfo.TraveTime,1==this.CTTAMCAS&&(this.Data.MCEquInfo.PreferentialAmount=(t*(.01*(100-n))).toFixed(2))},EditMCTN:function(t){var e=this;if(0==this.Data.MCEquInfo.TraveTime&&"Del"==t)return!1;var a={url:this.$store.state.http+"Maintain/EditMCTN",api:"post",data:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID,Type:t,Str:this.Data.MCEquInfo.TravelExpenses}};this.$https(a).then(function(t){e.initMaintenan()})},EditMCN:function(t){var e=this;if(0==this.Data.MCEquInfo.MaintainCount&&"Del"==t)return this.$look("warning","提示！","已达到最低保养次数！"),!1;var a={url:this.$store.state.http+"Maintain/EditMCN",api:"post",data:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID,Type:t}};this.$https(a).then(function(t){e.initMaintenan()})},EditMCEquMN:function(t,e){var a=this;if(0==t.MaintainCount&&"Del"==e)return this.$look("warning","提示！","已达到最低保养次数！"),!1;console.log(t,e);var i={url:this.$store.state.http+"Maintain/EditMCEquMN",api:"post",data:{Id:t.MCEquId,Type:e}};this.$https(i).then(function(t){a.initMaintenan()})},EditMCEqu:function(t,e,a){var i=this;if(console.log(t,e),1==t.Number_s&&"Del"==e)return this.delescoped(t,a),!1;var n={url:this.$store.state.http+"Maintain/EditMCEqu",api:"post",data:{Id:t.MCEquId,Type:e}};this.$https(n).then(function(t){i.initMaintenan()})},delescoped:function(t,e){var a=this,i={url:a.$store.state.http+"Maintain/DelEquToMC",api:"post",data:{Id:t.MCEquId}};a.$https(i).then(function(i){var n=[];(n="MC"==e?a.$refs.MC.tableData:a.$refs.AS.tableData).forEach(function(e,a){console.log(e.ProductId),e.ProductId==t.ProductId&&n.splice(a,1)});var s=[];n.forEach(function(t,e){s[e]={MaintainEquId:t.MCEquId,Desc:t.Desc,Pos:t.Pos,Sort:e+1}});var o={url:a.$store.state.http+"Maintain/AfreshEquSort",api:"post",data:{MaintainId:a.$store.state.Vuex.MaintenanceContractDetailsID,Dtos:s}};a.$https(o).then(function(t){setTimeout(function(){a.initMaintenan()},500)})})},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},MyEquipmentDatabase:function(t,e){this.pageNum=1,this.pagesize=10,this.initsss(e),this.code2=e,this.Manufacturer(),this.titlebatch="我的设备资料库",this.drawer=!0,this.Type=e,this.BelongToCustomer=t},EquipmentDatabase:function(t,e){this.pageNum=1,this.pagesize=10,this.initss(),this.Manufacturer(),this.titlebatch="设备资料库",this.drawer=!0,this.Type=e,this.BelongToCustomer=t},initMaintenan:function(){var t=this,e={url:this.$store.state.http+"Maintain/GetMC",api:"get",data:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID}};this.$https(e).then(function(e){t.Data=e.Data,console.log(t.Data),t.EquDtos1=t.mergeArr(e.Data.MCEquInfo.EquDtos),t.EquDtos=t.mergeArr(e.Data.ASEquInfo.EquDtos),console.log(t.EquDtos1),t.MCOrderDtos=e.Data.MCOrderDtos,t.EquDtos1List=t.mergeArr(e.Data.MCEquInfo.EquDtos),t.EquDtosList=t.mergeArr(e.Data.ASEquInfo.EquDtos),t.StateStr=t.Data.MCBaseInfo.State,"服务公司AS"==e.Data.MCBaseInfo.ContractType||"技术公司AS"==e.Data.MCBaseInfo.ContractType?t.PreferentialAmountSD=e.Data.ASEquInfo.ASPreferentialAmount+e.Data.MCEquInfo.TravelExpenses*e.Data.MCEquInfo.TraveTime:t.PreferentialAmountSD=e.Data.MCEquInfo.PreferentialAmount+e.Data.MCEquInfo.TravelExpenses*e.Data.MCEquInfo.TraveTime;var a=t;t.CTTAMC(),setTimeout(function(){a.rowDrop()},500),setTimeout(function(){a.rowDrops()},500),t.GetMCPlist(),t.CTTAMCAS=1})},mergeArr:function(t){var e=[];return console.log(t),t.forEach(function(t){if(t.Number_s=1,t.BelongToCustomer)return e.push(t),!0;if(0==e.length)return e.push(t),!0;var a=!0;e.forEach(function(e){if(e.ProductId==t.ProductId&&0==e.BelongToCustomer)return e.Number_s+=1,a=!1,!1}),a&&e.push(t)}),e},rowDrop:function(){var t=document.querySelector("#LEtetabe .el-table__body-wrapper tbody"),e=this;i.a.create(t,{onEnd:function(t){var a=t.newIndex,i=t.oldIndex;if(console.log(a,i),a==i)return!1;var n=e.EquDtos1List,s=n[i];n.splice(i,1),n.splice(a,0,s);for(var o=[],r=0;r<n.length;r++){var l=n[r];o[r]={MaintainEquId:l.MCEquId,Sort:r+1}}var u={url:e.$store.state.http+"Maintain/AfreshEquSort",api:"post",data:{MaintainId:e.$store.state.Vuex.MaintenanceContractDetailsID,Dtos:o}};e.$https(u).then(function(t){e.EquDtos1=[],e.initMaintenan()})}})},rowDrops:function(){var t=document.querySelector("#LEtetabes .el-table__body-wrapper tbody"),e=this;i.a.create(t,{onEnd:function(t){var a=t.newIndex,i=t.oldIndex;if(a==i)return!1;var n=e.EquDtosList,s=n[i];n.splice(i,1),n.splice(a,0,s);for(var o=[],r=0;r<n.length;r++){var l=n[r];o[r]={MaintainEquId:l.MCEquId,Sort:r+1}}var u={url:e.$store.state.http+"Maintain/AfreshEquSort",api:"post",data:{MaintainId:e.$store.state.Vuex.MaintenanceContractDetailsID,Dtos:o}};e.$https(u).then(function(t){e.EquDtos=[],e.initMaintenan()})}})},Manufacturer:function(){var t=this,e={url:this.$store.state.http+"System/GetBrand",api:"get"};this.$https(e).then(function(e){t.options=e.Data;for(var a=0;a<t.options.length;a++)t.options[a].value=t.options[a].Value;console.log(t.options)})},initss:function(){var t=this,e={api:"get",url:this.$store.state.http+"Product/GetProducts2",data:{pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:"",kitflag:!1,protype:2,productCode:this.productCode,barcodeMemo:this.barcodeMemo,man:this.man,desc:this.desc,memo:this.memo}};this.$https(e).then(function(e){t.total=e.Data.DataBars,t.Datatable=e.Data.Dtos;for(var a=0;a<t.Datatable.length;a++)t.Datatable[a].UpdateDate=t.Datatable[a].UpdateDate.split("T")[0],t.$set(t.Datatable[a],"Numberindex1",1);console.log(e.Data.Dtos)})},initsss:function(t){var e=this,a={api:"get",url:this.$store.state.http+"CRM/GetCustomerEqus",data:{pageNum:this.pageNum,numPerPage:this.pagesize,orderField:"",orderDirection:"",search:this.searchs,cusId:this.$store.state.CusId||this.Data.MCBaseInfo.CusId,onlyhavesn:this.CustomerType,otherType:t,sourceId:this.$store.state.Vuex.MaintenanceContractDetailsID}};this.$https(a).then(function(t){e.total=t.Data.DataBars,e.Datatable=t.Data.Dtos;for(var a=0;a<e.Datatable.length;a++)e.Datatable[a].Characteristics=e.Datatable[a].Desc,e.Datatable[a].UpdateDate=e.Datatable[a].BeganRunDate.split("T")[0],e.Datatable[a].Unit="无",e.Datatable[a].ProductCode=e.Datatable[a].ProdcutCode,e.Datatable[a].Manufacturer=e.Datatable[a].Brand,e.Datatable[a].BarcodeMemo=" - ",e.$set(e.Datatable[a],"Numberindex1",1);console.log(e.Datatable)})},addscheck:function(){var t=this;console.log(this.$refs.multipleTable.selection);for(var e=[],a=this.$refs.multipleTable.selection,i=0;i<a.length;i++){var n=a[i];e.push({BelongToCustomer:this.BelongToCustomer,EquId:n.ID||n.Id,Type:this.Type,Number:n.Numberindex1})}var s={api:"post",url:this.$store.state.http+"Maintain/AddEquToMC",data:{MCId:this.$store.state.Vuex.MaintenanceContractDetailsID,EquToMCDtos:e}};this.$https(s).then(function(e){t.drawer=!1,t.initMaintenan()})},adds:function(t){var e=this;console.log(t);var a={api:"post",url:this.$store.state.http+"Maintain/AddEquToMC",data:{MCId:this.$store.state.Vuex.MaintenanceContractDetailsID,EquToMCDtos:[{BelongToCustomer:this.BelongToCustomer,EquId:t.ID||t.Id,Type:this.Type,Number:t.Numberindex1}]}};this.$https(a).then(function(t){e.drawer=!1,e.initMaintenan()})},handleCurrentChange:function(t){this.pageNum=t,0==this.BelongToCustomer?this.initss():this.initsss(this.code2)},handleSizeChange:function(t){this.pagesize=t,0==this.BelongToCustomer?this.initss():this.initsss(this.code2)},Numberindexadddel:function(t,e){console.log(t),console.log(e)},AddMCOrderDtos:function(){var t=this;if(""==this.Time1||null==this.Time1||void 0==this.Time1)return this.$look("warning","提示！","请选择日期！"),!1;var e={url:this.$store.state.http+"Maintain/CreateMCOrder",api:"post",data:{Id:this.$store.state.Vuex.MaintenanceContractDetailsID,Str:this.Time1}};this.$https(e).then(function(e){t.initMaintenan()})},httpTXFWQBYHT:function(t){if("MC"==t||"AS"==t){var e=this.$router.resolve({path:this.$store.state.Vuex.TencentServer+"/AS&MC/"+t+".html",query:{url:n.encodeURI(this.$store.state.http+"Maintain/GetMaintainContract"),ID:n.encodeURI(this.$store.state.Vuex.MaintenanceContractDetailsID),token:n.encodeURI(localStorage.getItem("token"))}}).href;window.open(e.slice(2),"_blank")}else if("ASs"==t){var a=this.$router.resolve({path:this.$store.state.Vuex.TencentServer+"/AS&MC/"+t+".html",query:{url:n.encodeURI(this.$store.state.http+"Maintain/GetMCYu"),ID:n.encodeURI(this.$store.state.Vuex.MaintenanceContractDetailsID),token:n.encodeURI(localStorage.getItem("token"))}}).href;window.open(a.slice(2),"_blank")}else{var i=this.$router.resolve({path:this.$store.state.Vuex.TencentServer+"/AS&MC/"+t+".html",query:{url:n.encodeURI(this.$store.state.http+"Maintain/GetMCAppendix"),ID:n.encodeURI(this.$store.state.Vuex.MaintenanceContractDetailsID),token:n.encodeURI(localStorage.getItem("token"))}}).href;window.open(i.slice(2),"_blank")}},sortchange:function(t){var e=this;if(1==t)var a=e.$refs.MC.tableData;else a=e.$refs.AS.tableData;for(var i=[],n=0;n<a.length;n++){var s=a[n];i[n]={MaintainEquId:s.MCEquId,Desc:s.Desc,Pos:s.Pos,Sort:n+1}}console.log(i);var o={url:e.$store.state.http+"Maintain/AfreshEquSort",api:"post",data:{MaintainId:e.$store.state.Vuex.MaintenanceContractDetailsID,Dtos:i}};e.$https(o).then(function(t){e.EquDtos1=[],setTimeout(function(){e.initMaintenan()},500)})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_s BJmanagementHTbox_s"},[t.Data.MCBaseInfo?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n      保养合同基础信息 【 "+t._s(t.Data.MCBaseInfo.MaintainCode)+" 】\n      "),a("div",{staticStyle:{width:"50px",height:"50px",float:"right","z-index":"99"},on:{mouseover:function(e){t.MaintainRHF=!0},mouseleave:function(e){t.MaintainRHF=!1}}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.MaintainRHF,expression:"MaintainRHF"}],staticStyle:{float:"right"},attrs:{size:"mini",type:"success",icon:"el-icon-refresh"},on:{click:function(e){return t.ResetMC()}}})],1)]),t._v(" "),a("div",{staticClass:"itemmsgxx_document",staticStyle:{width:"600px"}},[a("p",[a("span",[t._v("客户名称:")]),t._v(t._s(t.Data.MCBaseInfo.CusFullName))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("合同类型:")]),t._v(t._s(t.Data.MCBaseInfo.ContractType))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("合同号:")]),t._v(t._s(t.Data.MCBaseInfo.MaintainCode))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("区域:")]),t._v(t._s(t.Data.MCBaseInfo.Area))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("设备数量:")]),t._v(t._s(t.Data.MCBaseInfo.EquCount))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("创建日期:")]),t._v(t._s(t._f("TimeCode")(t.Data.MCBaseInfo.CreateDate)))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("报价日期:")]),t._v(t._s(t._f("TimeCode")(t.Data.MCBaseInfo.AcceptDate)))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("付款日期:")]),t._v(t._s(t._f("TimeCode")(t.Data.MCBaseInfo.PayDate)))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("结单日期:")]),t._v(t._s(t._f("TimeCode")(t.Data.MCBaseInfo.EndDate)))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("销售员:")]),t._v(t._s(t.Data.MCBaseInfo.SalesPerson))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("当前状态:")]),t._v(t._s(t.Data.MCBaseInfo.StateStr))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("联系人:")]),t._v(t._s(t.Data.MCBaseInfo.LinkMan))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("联系人英文名:")]),t._v(t._s(t.Data.MCBaseInfo.LinkManEngilsh))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v(" 联系人手机号:")]),t._v(t._s(t.Data.MCBaseInfo.Mobile))])]),t._v(" "),a("div",{staticClass:"itemmsgxX_document"},[a("p",[a("span",[t._v("备注信息:")]),t._v(t._s(t.Data.MCBaseInfo.Memo))])]),t._v(" "),a("div",{staticClass:"segmentation"},[t._v("\n      保养设备信息\n      "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(e){return t.MyEquipmentDatabase(!0,"1")}}},[t._v("我的设备资料库")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.EquipmentDatabase(!1,"1")}}},[t._v("设备资料库")])],1),t._v(" "),a("div",{attrs:{id:"LEtetabe"}},[a("el-table",{ref:"MC",attrs:{data:t.EquDtos1,border:"","row-key":"id",size:"mini","header-cell-style":{background:"#e1e1e1"},align:"left"},on:{"sort-change":function(e){return t.sortchange(1)}}},[t._l(t.col,function(e,i){return a("el-table-column",{key:"col_"+e.label,attrs:{prop:t.dropCol[i].prop,sortable:e.sortable,width:t.dropCol[i].width,"show-overflow-tooltip":t.dropCol[i].widths,label:e.label}})}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"数量",width:"105"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.BelongToCustomer?t._e():a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.EditMCEqu(e.row,"Del","MC")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("span",[t._v(t._s(e.row.Number_s))])]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.EditMCEqu(e.row,"Add","MC")}}},[a("i",{staticClass:"el-icon-plus"})])]),t._v(" "),e.row.BelongToCustomer?a("div",{staticStyle:{width:"100%",textalign:"center"}},[t._v("\n              "+t._s(e.row.Number_s)+"\n            ")]):t._e()]}}],null,!1,997297537)}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"保养次数",width:"105"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.EditMCEquMN(e.row,"Del")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("span",[t._v(t._s(e.row.MaintainCount))])]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.EditMCEquMN(e.row,"Add")}}},[a("i",{staticClass:"el-icon-plus"})])])]}}],null,!1,218488519)}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.delescoped(e.row,"MC")}}},[t._v("删除")])]}}],null,!1,432510098)})],2)],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("合同年限:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},model:{value:t.Data.MCEquInfo.YearLife,callback:function(e){t.$set(t.Data.MCEquInfo,"YearLife",e)},expression:"Data.MCEquInfo.YearLife"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("保养次数:")]),t._v(" "),a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(e){return t.EditMCN("Del")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("span",{staticStyle:{width:"100%"}},[t._v(t._s(t.Data.MCEquInfo.MaintainCount))])]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(e){return t.EditMCN("Add")}}},[a("i",{staticClass:"el-icon-plus"})])])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("差旅费:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},on:{input:t.CTTAMC},model:{value:t.Data.MCEquInfo.TravelExpenses,callback:function(e){t.$set(t.Data.MCEquInfo,"TravelExpenses",e)},expression:"Data.MCEquInfo.TravelExpenses"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("差旅次数:")]),t._v(" "),a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(e){return t.EditMCTN("Del")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("span",{staticStyle:{width:"100%"}},[t._v(t._s(t.Data.MCEquInfo.TraveTime))])]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(e){return t.EditMCTN("Add")}}},[a("i",{staticClass:"el-icon-plus"})])])]),t._v(" "),a("div",{staticClass:"itemmsgxX_document",staticStyle:{height:"1px",margin:"0",padding:"0"}}),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",[t._v("总金额(RMB):")]),t._v(t._s(t.Data.MCEquInfo.AmountTotal.toFixed(2)))])]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("优惠比例(%):")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},on:{input:t.CTTAMC},model:{value:t.Data.MCEquInfo.PreferentialRatio,callback:function(e){t.$set(t.Data.MCEquInfo,"PreferentialRatio",e)},expression:"Data.MCEquInfo.PreferentialRatio"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("优惠后金额:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},model:{value:t.Data.MCEquInfo.PreferentialAmount,callback:function(e){t.$set(t.Data.MCEquInfo,"PreferentialAmount",e)},expression:"Data.MCEquInfo.PreferentialAmount"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxX_document",staticStyle:{height:"1px",margin:"0",padding:"0"}}),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("p",[a("span",{staticStyle:{width:"200px"}},[t._v("是否在合同中显示折扣率:")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.Data.MCEquInfo.IsShowDiscount,callback:function(e){t.$set(t.Data.MCEquInfo,"IsShowDiscount",e)},expression:"Data.MCEquInfo.IsShowDiscount"}})],1)]),t._v(" "),"服务公司AS"==t.Data.MCBaseInfo.ContractType||"技术公司AS"==t.Data.MCBaseInfo.ContractType?a("div",[a("div",{staticClass:"segmentation"},[t._v("\n        大包设备信息\n        "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(e){return t.MyEquipmentDatabase(!0,"2")}}},[t._v("我的设备资料库")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.EquipmentDatabase(!1,"2")}}},[t._v("设备资料库")])],1),t._v(" "),a("div",{attrs:{id:"LEtetabes"}},[a("el-table",{ref:"AS",attrs:{data:t.EquDtos,border:"","row-key":"ids",size:"mini","header-cell-style":{background:"#e1e1e1"},align:"left"},on:{"sort-change":function(e){return t.sortchange(2)}}},[t._l(t.col,function(e,i){return a("el-table-column",{key:"col_"+i,attrs:{prop:t.dropCol[i].prop,sortable:e.sortable,width:t.dropCol[i].width,"show-overflow-tooltip":t.dropCol[i].widths,label:e.label}})}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"数量",width:"105"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.BelongToCustomer?t._e():a("div",{attrs:{id:"Number_input"}},[a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.EditMCEqu(e.row,"Del","AS")}}},[a("i",{staticClass:"el-icon-minus"})]),t._v(" "),a("div",{staticClass:"div_icon_textConter"},[a("span",[t._v(t._s(e.row.Number_s))])]),t._v(" "),a("div",{staticClass:"div_icon_text",on:{click:function(a){return t.EditMCEqu(e.row,"Add","AS")}}},[a("i",{staticClass:"el-icon-plus"})])]),t._v(" "),e.row.BelongToCustomer?a("div",{staticStyle:{width:"100%",textalign:"center"}},[t._v("\n                "+t._s(e.row.Number_s)+"\n              ")]):t._e()]}}],null,!1,992356353)}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.delescoped(e.row,"AS")}}},[t._v("删除")])]}}],null,!1,777998990)})],2)],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("建店年份:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},on:{input:t.ChangeASPreferentialAmount},model:{value:t.Data.ASEquInfo.YearOfEstablishment,callback:function(e){t.$set(t.Data.ASEquInfo,"YearOfEstablishment",e)},expression:"Data.ASEquInfo.YearOfEstablishment"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxx_documentLength"},[a("span",[t._v("去年售后维修花费:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},on:{input:t.ChangeASPreferentialAmount},model:{value:t.Data.ASEquInfo.QNHF,callback:function(e){t.$set(t.Data.ASEquInfo,"QNHF",e)},expression:"Data.ASEquInfo.QNHF"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("举升机数量:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},on:{input:t.ChangeASPreferentialAmount},model:{value:t.Data.ASEquInfo.TotalNumberOfLifts,callback:function(e){t.$set(t.Data.ASEquInfo,"TotalNumberOfLifts",e)},expression:"Data.ASEquInfo.TotalNumberOfLifts"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("空压机数量:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},on:{input:t.ChangeASPreferentialAmount},model:{value:t.Data.ASEquInfo.TotalNumberOfAirCompressor,callback:function(e){t.$set(t.Data.ASEquInfo,"TotalNumberOfAirCompressor",e)},expression:"Data.ASEquInfo.TotalNumberOfAirCompressor"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("烤漆房数量:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},on:{input:t.ChangeASPreferentialAmount},model:{value:t.Data.ASEquInfo.TotalNumberOfSprayBooth,callback:function(e){t.$set(t.Data.ASEquInfo,"TotalNumberOfSprayBooth",e)},expression:"Data.ASEquInfo.TotalNumberOfSprayBooth"}})],1),t._v(" "),a("div",{staticClass:"itemmsgxX_document",staticStyle:{height:"1px",margin:"0",padding:"0"}}),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("AS金额合计:")]),t._v("\n        "+t._s(t.Data.ASEquInfo.ASAmountTotal.toFixed(2))+"\n      ")]),t._v(" "),a("div",{staticClass:"itemmsgxx_document"},[a("span",[t._v("AS优惠后金额:")]),t._v(" "),a("el-input",{staticStyle:{width:"50%"},attrs:{size:"mini"},model:{value:t.Data.ASEquInfo.ASPreferentialAmount,callback:function(e){t.$set(t.Data.ASEquInfo,"ASPreferentialAmount",e)},expression:"Data.ASEquInfo.ASPreferentialAmount"}})],1)]):t._e(),t._v(" "),2==t.StateStr||3==t.StateStr||4==t.StateStr||5==t.StateStr||9==t.StateStr?a("div",{staticClass:"segmentation"},[t._v("下载合同")]):t._e(),t._v(" "),2==t.StateStr||3==t.StateStr||4==t.StateStr||5==t.StateStr||9==t.StateStr?a("div",{staticClass:"div",staticStyle:{width:"100%",float:"left"}},["服务公司MC"==t.Data.MCBaseInfo.ContractType||"技术公司MC"==t.Data.MCBaseInfo.ContractType?a("div",{staticClass:"Fl"},[a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.httpTXFWQBYHT("MC")}}},[t._v("合同")]),t._v(" "),a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.httpTXFWQBYHT("MC2")}}},[t._v("附件2")])],1):t._e(),t._v(" "),"服务公司AS"==t.Data.MCBaseInfo.ContractType||"技术公司AS"==t.Data.MCBaseInfo.ContractType?a("div",{staticClass:"Fl"},[a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.httpTXFWQBYHT("ASs")}}},[t._v("AS预报价方案")]),t._v(" "),a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.httpTXFWQBYHT("AS")}}},[t._v("合同")]),t._v(" "),a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.httpTXFWQBYHT("AS2")}}},[t._v("附件2")]),t._v(" "),a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.httpTXFWQBYHT("AS3")}}},[t._v("附件3")])],1):t._e()]):t._e(),t._v(" "),4==t.StateStr||5==t.StateStr||9==t.StateStr?a("div",{staticClass:"segmentation"},[t._v("收款记录\n      "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:function(e){return t.MCCollections()}}},[t._v("发起收款")]),t._v(" "),a("p",{staticStyle:{float:"right",color:"#000"}},[t._v("  ")]),t._v(" "),a("el-input",{staticStyle:{width:"100px",float:"right"},attrs:{size:"mini",placeholder:"元 / 人民币"},model:{value:t.MCCollectionss,callback:function(e){t.MCCollectionss=e},expression:"MCCollectionss"}}),t._v(" "),a("p",{staticStyle:{float:"right",color:"#000"}},[t._v("\n        (财务已确认："+t._s(t.FinancialConfirmed+" 元")+" )   \n      ")]),t._v(" "),a("p",{staticStyle:{float:"right",color:"#000"}},[t._v("\n        (等待确认："+t._s(t.FinancialUnconfirmed+" 元")+" )   \n      ")]),t._v(" "),a("p",{staticStyle:{float:"right",color:"#000"}},[t._v("\n        (共计应收："+t._s(t.PreferentialAmountSD+" 元")+"\n        )   \n      ")])],1):t._e(),t._v(" "),4==t.StateStr||5==t.StateStr||9==t.StateStr?a("div",{staticClass:"timeline"},[a("el-timeline",{attrs:{reverse:t.reverse}},t._l(t.GetMCPlistData,function(e,i){return a("el-timeline-item",{key:i,attrs:{color:2==e.State?"#67C23A":"#909399",timestamp:e.Other}},[t._v("\n          "+t._s(e.Amount+" 元 - - "+e.StateStr)+"\n        ")])}),1)],1):t._e(),t._v(" "),a("div",{staticClass:"itemmsgxX_document",staticStyle:{height:"1px",margin:"0",padding:"0"}}),t._v(" "),4==t.StateStr||5==t.StateStr||9==t.StateStr?a("div",{staticClass:"segmentation"},[t._v("\n      任务列表\n      "),a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"success"},on:{click:function(e){return t.AddMCOrderDtos()}}},[t._v("添加任务")]),t._v(" "),a("el-date-picker",{staticStyle:{float:"right"},attrs:{type:"date",size:"mini",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期，添加任务"},model:{value:t.Time1,callback:function(e){t.Time1=e},expression:"Time1"}}),t._v(" "),4==t.StateStr?a("el-button",{staticStyle:{float:"right",marginRight:"50px"},attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.SkipTheMaintenanceTask()}}},[t._v("跳过保养任务")]):t._e()],1):t._e(),t._v(" "),4==t.StateStr||5==t.StateStr||9==t.StateStr?a("div",{attrs:{id:"LEtetabes"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.MCOrderDtos,size:"mini","highlight-current-row":"",border:"","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{fixed:"",prop:"EstimatedTime",label:"预计时间",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"ActualTime",label:"启动时间",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"EndTime",label:"完成时间",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"Enginners",label:"工程师",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"StateStr",label:"状态"}})],1)],1):t._e(),t._v(" "),a("div",{staticClass:"segmentation"},[t._v("备注")]),t._v(" "),a("el-input",{staticStyle:{margin:"10px 20px 50px 20px",width:"500px"},attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.Data.MCBaseInfo.Memo,callback:function(e){t.$set(t.Data.MCBaseInfo,"Memo",e)},expression:"Data.MCBaseInfo.Memo"}}),t._v(" "),0==t.StateStr||1==t.StateStr||2==t.StateStr?a("el-button",{staticStyle:{float:"right",margin:"20px"},attrs:{size:"mini",type:"danger",loading:this.$store.state.Vuex.loading},on:{click:function(e){return t.saveMCAS(6,"撤单")}}},[t._v("撤单")]):t._e(),t._v(" "),0==t.StateStr||1==t.StateStr||2==t.StateStr?a("el-button",{staticStyle:{float:"right",margin:"20px"},attrs:{size:"mini",type:"primary",loading:this.$store.state.Vuex.loading},on:{click:function(e){return t.saveMCAS()}}},[t._v("保存")]):t._e(),t._v(" "),0==t.StateStr||1==t.StateStr||2==t.StateStr?a("el-button",{staticStyle:{float:"right",margin:"20px"},attrs:{size:"mini",type:"warning",loading:this.$store.state.Vuex.loading},on:{click:function(e){return t.saveMCAS(2,"向客户报价")}}},[t._v("向客户报价\n    ")]):t._e(),t._v(" "),2==t.StateStr?a("el-button",{staticStyle:{float:"right",margin:"20px"},attrs:{size:"mini",type:"danger",loading:this.$store.state.Vuex.loading},on:{click:function(e){return t.saveMCAS(3,"替客户确认报价")}}},[t._v("替客户确认报价")]):t._e(),t._v(" "),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.WhetherToRenew,callback:function(e){t.WhetherToRenew=e},expression:"WhetherToRenew"}},[a("p",[t._v("这是一段内容这是一段内容确定删除吗？")]),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.WhetherToRenew=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.WhetherToRenew=!1}}},[t._v("确定")])],1)]),t._v(" "),3==t.StateStr?a("el-button",{staticStyle:{float:"right",margin:"20px"},attrs:{slot:"reference",size:"mini",type:"primary",loading:this.$store.state.Vuex.loading},on:{click:function(e){return t.confirmOldContracts()}},slot:"reference"},[t._v("收款")]):t._e(),t._v(" "),10==t.StateStr?a("el-button",{staticStyle:{float:"right",margin:"20px"},attrs:{slot:"reference",size:"mini",type:"primary",loading:this.$store.state.Vuex.loading},on:{click:function(e){return t.Receivables(4,"收款")}},slot:"reference"},[t._v("收款")]):t._e(),t._v(" "),a("el-drawer",{staticStyle:{width:"200%"},attrs:{visible:t.drawer,direction:"ltr",modal:!1,title:t.titlebatch,"before-close":t.handleClose},on:{"update:visible":function(e){t.drawer=e}}},[1==this.BelongToCustomer?a("div",{staticClass:"top_init_data",staticStyle:{marginbottom:"10px"}},[a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"序列号、别名、产品描述"},on:{change:function(e){return t.initsss()}},model:{value:t.searchs,callback:function(e){t.searchs=e},expression:"searchs"}}),t._v(" "),a("el-select",{staticStyle:{width:"140px"},attrs:{size:"mini",placeholder:"是否有序列号"},on:{change:function(e){return t.initsss()}},model:{value:t.CustomerType,callback:function(e){t.CustomerType=e},expression:"CustomerType"}},t._l(t.CustomerTypes,function(t){return a("el-option",{key:t.value+"99",attrs:{label:t.name,value:t.value}})}),1),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.initsss()}}},[t._v("检索")])],1):t._e(),t._v(" "),0==this.BelongToCustomer?a("div",{staticClass:"top_init_data",staticStyle:{marginbottom:"10px"}},[a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入产品编码"},on:{change:function(e){return t.initss()}},model:{value:t.productCode,callback:function(e){t.productCode=e},expression:"productCode"}}),t._v(" "),a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入内部编码"},on:{change:function(e){return t.initss()}},model:{value:t.barcodeMemo,callback:function(e){t.barcodeMemo=e},expression:"barcodeMemo"}}),t._v(" "),a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入产品描述"},on:{change:function(e){return t.initss()}},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}}),t._v(" "),a("el-input",{staticStyle:{width:"193px"},attrs:{size:"mini",placeholder:"请输入产品备注"},on:{change:function(e){return t.initss()}},model:{value:t.memo,callback:function(e){t.memo=e},expression:"memo"}}),t._v(" "),a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"200px"},attrs:{size:"mini","show-overflow-tooltip":!0,"fetch-suggestions":t.querySearch,placeholder:"请选择品牌",clearable:""},on:{select:t.handleSelect},model:{value:t.man,callback:function(e){t.man=e},expression:"man"}}),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.initss()}}},[t._v("检索")])],1):t._e(),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{marginbottom:"10px"},attrs:{data:t.Datatable,size:"mini",height:this.$store.state.TableOptimumHeight,border:"","header-cell-style":{background:"#e1e1e1"}}},[a("el-table-column",{attrs:{prop:"ProductCode",label:"产品编号",width:"170"}}),t._v(" "),0==this.BelongToCustomer?a("el-table-column",{attrs:{prop:"BarcodeMemo",label:"内部编码",width:"140"}}):t._e(),t._v(" "),1==this.BelongToCustomer?a("el-table-column",{attrs:{prop:"SN",label:"序列号",width:"130"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"Manufacturer",label:"品牌",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Characteristics",label:"产品描述","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{staticStyle:{float:"left"},attrs:{fixed:"right",type:"selection",width:"55"}}),t._v(" "),0==this.BelongToCustomer?a("el-table-column",{staticStyle:{float:"left"},attrs:{fixed:"right",label:"添加数量",width:"154"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{min:1,size:"mini"},model:{value:e.row.Numberindex1,callback:function(a){t.$set(e.row,"Numberindex1",a)},expression:"scope.row.Numberindex1"}})]}}],null,!1,58646570)}):t._e(),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.adds(e.row)}}},[t._v("添加")])]}}],null,!1,4106511513)})],1),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.addscheck()}}},[t._v("添加选择")]),t._v(" "),a("nav",{staticStyle:{"text-align":"center"}},[a("el-pagination",{staticClass:"pagition-li",attrs:{"current-page":1,"page-sizes":this.$store.state.Vuex.pageSNumber,"page-size":t.pagesize,layout:" total , sizes, prev, pager, next, jumper ",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"请选择被续签的合同",visible:t.ContractWithOptionOfRenewal,"modal-append-to-body":!1,height:this.$store.state.TableOptimumHeight},on:{"update:visible":function(e){t.ContractWithOptionOfRenewal=e}}},[a("el-table",{ref:"SelectedContracts",attrs:{data:t.DataList}},[a("el-table-column",{attrs:{prop:"ContractType",label:"合同类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"MaintainCode",label:"合同号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"Area",label:"区域"}}),t._v(" "),a("el-table-column",{attrs:{prop:"EquCount",label:"数量","show-overflow-tooltip":!0}}),t._v(" "),a("el-table-column",{attrs:{prop:"CreateDate",label:"创建日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"StateStr",label:"当前状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"SalesPerson",label:"销售员"}}),t._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.ContractWithOptionOfRenewal=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.IveChosen()}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(s,o,!1,function(t){a("wGyO")},null,null);e.default=r.exports},wGyO:function(t,e){}});